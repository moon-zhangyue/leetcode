<?php
//ç»™å®šä¸¤ä¸ªæ•´æ•° a å’Œ b ï¼Œæ±‚å®ƒä»¬çš„é™¤æ³•çš„å•† a/b ï¼Œè¦æ±‚ä¸å¾—ä½¿ç”¨ä¹˜å· '*'ã€é™¤å· '/' ä»¥åŠæ±‚ä½™ç¬¦å· '%' ã€‚ 
//
// 
//
// æ³¨æ„ï¼š 
//
// 
// æ•´æ•°é™¤æ³•çš„ç»“æœåº”å½“æˆªå»ï¼ˆtruncateï¼‰å…¶å°æ•°éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼štruncate(8.345) = 8 ä»¥åŠ truncate(-2.7335) = -2 
// å‡è®¾æˆ‘ä»¬çš„ç¯å¢ƒåªèƒ½å­˜å‚¨ 32 ä½æœ‰ç¬¦å·æ•´æ•°ï¼Œå…¶æ•°å€¼èŒƒå›´æ˜¯ [âˆ’2Â³Â¹, 2Â³Â¹âˆ’1]ã€‚æœ¬é¢˜ä¸­ï¼Œå¦‚æœé™¤æ³•ç»“æœæº¢å‡ºï¼Œåˆ™è¿”å› 231 âˆ’ 1 
// 
//
// 
//
// ç¤ºä¾‹ 1ï¼š 
//
// 
//è¾“å…¥ï¼ša = 15, b = 2
//è¾“å‡ºï¼š7
//è§£é‡Šï¼š15/2 = truncate(7.5) = 7
// 
//
// ç¤ºä¾‹ 2ï¼š 
//
// 
//è¾“å…¥ï¼ša = 7, b = -3
//è¾“å‡ºï¼š-2
//è§£é‡Šï¼š7/-3 = truncate(-2.33333..) = -2 
//
// ç¤ºä¾‹ 3ï¼š 
//
// 
//è¾“å…¥ï¼ša = 0, b = 1
//è¾“å‡ºï¼š0 
//
// ç¤ºä¾‹ 4ï¼š 
//
// 
//è¾“å…¥ï¼ša = 1, b = 1
//è¾“å‡ºï¼š1 
//
// 
//
// æç¤º: 
//
// 
// -2Â³Â¹ <= a, b <= 2Â³Â¹ - 1 
// b != 0 
// 
//
// 
//
// æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 29 é¢˜ç›¸åŒï¼šhttps://leetcode-cn.com/problems/divide-two-integers/ 
//
// 
// Related Topics ä½è¿ç®— æ•°å­¦ ğŸ‘ 60 ğŸ‘ 0


//leetcode submit region begin(Prohibit modification and deletion)
class Solution
{
//ï¼ˆå‡¡æ˜¯ ä¸èƒ½ç”¨ä¹˜é™¤æ³•ï¼Œæˆ–è€…è¦æ±‚ä¼˜åŒ– ä¹˜é™¤æ³•çš„æ€§èƒ½é—®é¢˜ï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ ä½è¿ç®—ï¼‰
    /**
     * @param Integer $a
     * @param Integer $b
     *
     * @return Integer
     */
    function divide(int $a, int $b): int
    {
        /*
         * ä¸€ä¸ªå¾ˆç›´è§‚çš„æƒ³æ³•æ˜¯åŸºäºå‡æ³•å®ç°é™¤æ³•ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†æ±‚ 19/2 å¯ä»¥ä» 19 ä¸­ä¸æ–­å‡å» 2ï¼Œé‚£ä¹ˆå‡å» 9 ä¸ª 2 ä»¥åå°±å‰©ä¸‹ 1ï¼Œå¯ä»¥å¾—åˆ° 19/2 = 9ï¼Œä½†æ˜¯æ•ˆç‡å¾ˆä½ï¼Œå½“è¢«é™¤æ•°æ˜¯ n,é™¤æ•°æ˜¯ 1 çš„æ—¶å€™ï¼Œç®—æ³•å¤æ‚åº¦æœ€å·®ä¸º O(n)ã€‚å¦‚æœå°†ä¸Šè¿°è§£æ³•åšä¸€äº›è°ƒæ•´ï¼Œå½“è¢«é™¤æ•°å¤§äºé™¤æ•°æ—¶ï¼Œç»§ç»­åˆ¤æ–­æ˜¯ä¸æ˜¯å¤§äºé™¤æ•°çš„ 2 å€ï¼Ÿ 4 å€ï¼Ÿ 8 å€ï¼Ÿ....å¦‚æœè¢«é™¤æ•°å¤§äºé™¤æ•°çš„ 2^k å€ï¼Œé‚£ä¹ˆå°†è¢«é™¤æ•°å‡å»é™¤æ•°çš„ 2^ k å€ï¼Œä¹‹åå†é‡å¤ä»¥ä¸Šæ­¥éª¤ã€‚

ä¸¾ä¸ªä¾‹å­ 19/2ï¼Œ19 å¤§äº 2ï¼Œä¹Ÿå¤§äº 4 (2 * 2 ^ (1))ï¼Œä¹Ÿå¤§äº 8 (2 * 2 ^ (2))ï¼Œä¹Ÿå¤§äº 16 (2 * 2 ^ (3))ï¼Œä½†æ˜¯å°äº 32 (2 * 2 ^ (4))ï¼Œäºæ˜¯å°† 19 - 16 å¾—åˆ° 3ï¼Œå¹¶è®°å½•æ­¤æ—¶çš„ç­”æ¡ˆ 8ï¼Œæ­¤æ—¶è¢«é™¤æ•°å˜ä¸º 3ï¼Œé™¤æ•°è¿˜æ˜¯ 2ï¼Œé‡å¤ä¸Šè¿°ç»“æœå¾—åˆ°æ­¤æ—¶ç­”æ¡ˆä¸º 1ï¼Œå‰©ä¸‹è¢«é™¤æ•° 1ï¼Œå·²ç»å°äº 2ï¼Œæœ€ç»ˆç»“æœä¸º 8 + 1 = 9ã€‚ç®—æ³•å¤æ‚åº¦ä¸º O(logn)ã€‚

ä¸Šè¿°åˆ†æè¿‡ç¨‹éƒ½æ˜¯åŸºäºè¢«é™¤æ•°å’Œé™¤æ•°éƒ½æ˜¯æ­£æ•´æ•°ï¼Œå¦‚æœå­˜åœ¨è´Ÿæ•´æ•°åˆ™å¯ä»¥å°†ä»–ä»¬å…ˆè½¬åŒ–ä¸ºæ­£æ•´æ•°è¿›è¡Œè®¡ç®—ï¼Œæœ€åæ ¹æ®ç¬¦å·è°ƒæ•´ç»“æœã€‚ä½†æ˜¯å¯¹äº 32 ä½ int æ¥è®²ï¼Œæœ€å¤§çš„æ­£æ•°ä¸º 2^31-1,æœ€å°çš„è´Ÿæ•°ä¸º -2^31,å¦‚æœå°†è´Ÿæ•°è½¬åŒ–ä¸ºæ­£æ•°ä¼šæº¢å‡ºï¼Œæ‰€ä»¥å¯ä»¥å°†æ­£æ•°éƒ½è½¬åŒ–ä¸ºè´Ÿæ•°è®¡ç®—ï¼Œæ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯å¯¹ä¸¤ä¸ªè´Ÿæ•°è¿›è¡Œé™¤æ³•ï¼Œè¿”å›çš„ç»“æœå¯ä»¥ç”¨æ— ç¬¦å·æ•°è¿”å›ï¼Œæœ€åè¿›è¡Œæ­£è´Ÿå·è°ƒæ•´ã€‚å¦å¤–æ‰€æœ‰çš„ç»“æœä¸­å­˜åœ¨ä¸€ç§æƒ…å†µæ— æ³•ç”¨ int è¡¨ç¤ºç»“æœï¼Œé‚£å°±æ˜¯è¢«é™¤æ•°ä¸º -2^31ï¼Œé™¤æ•°ä¸º -1ï¼Œè¿™æ—¶å€™ç›´æ¥ç‰¹æ®Šåˆ¤æ–­è¾“å‡º INT_MAX å°±è¡Œã€‚
         * */
        //PHPè¶…æ—¶
        if ($a == PHP_INT_MAX && $b === -1) {//æœ€å¤§æ•´æ•°å€¼
            return PHP_INT_MAX;
        }
        $negative = 2; //è¢«é™¤æ•°
        if ($a > 0) {
            $negative--;
            $a = -$a;
        }
        if ($b > 0) {
            $negative--;
            $b = -$b;
        }
        $res = $this->divideCore($a, $b);
        return $negative == 1 ? -$res : $res;
    }

    function divideCore(int $a, int $b)
    {
        $ret = 0;
        // æ³¨æ„a, béƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥a <= bå°±æ˜¯è¿˜å¯ä»¥ç»§ç»­é™¤
        while ($a <= $b) {
            $value = $b;
            $quo   = 1;
            while ($value >= 0xc0000000 && $a <= $value + $value) {
                $quo   += $quo;
                $value += $value;
            }
            $ret += $quo;
            $a   -= $value;
        }
        return $ret;
    }


    //ä½è¿ç®—
    /*
     * æ ¹æ® ä¸¤æ•° æ­£è´Ÿå·ï¼Œç”Ÿæˆflagçš„å€¼ï¼Œä»¥ä¾¿ç»“æœçš„æ­£è´Ÿå·å¤„ç†
ç»™ ä¸¤æ•° å–ç»å¯¹å€¼
å‰ªæï¼Œè‹¥ å½“å‰è¢«é™¤æ•° å°äº å½“å‰é™¤æ•°ï¼Œåˆ™è¿”å›0
å¾ªç¯è®¡ç®— ç»“æœçš„ç»å¯¹å€¼
åˆ›å»ºä¸€ä¸ªå˜é‡shiftï¼Œè®°å½• å½“å‰å·¦ç§»ä½æ•°
è‹¥ å½“å‰é™¤æ•° å°äº å½“å‰è¢«é™¤æ•°ï¼Œä¸€ç›´å·¦ç§» å½“å‰é™¤æ•°ï¼Œç›´åˆ° å½“å‰é™¤æ•° å¤§äºç­‰äº å½“å‰è¢«é™¤æ•°
è®°å½• å½“å‰shiftçš„å€¼ï¼Œå¹¶æ ¹æ®å½“å‰shiftçš„å€¼ï¼Œè®¡ç®— ä¸‹ä¸€è½®å¾ªç¯ä¸­çš„ é™¤æ•° å’Œ è¢«é™¤æ•°
æ ¹æ®è®¡ç®—çš„ç»“æœ å’Œ flagï¼Œè¿”å›æ­£ç¡®çš„ç»“æœ
ï¼ˆå‡¡æ˜¯ ä¸èƒ½ç”¨ä¹˜é™¤æ³•ï¼Œæˆ–è€…è¦æ±‚ä¼˜åŒ– ä¹˜é™¤æ³•çš„æ€§èƒ½é—®é¢˜ï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ ä½è¿ç®—ï¼‰
     * */
    function divides(int $a, int $b): int
    {
        if ($a == -2147483648 && $b == -1) { //æ­¤å¤„ä¸ç”¨PHP_INT_MINå’ŒPHP_INT_MAX  å› ä¸ºæ˜¯64ä½ç³»ç»Ÿ
            return 2147483647;
        }

        //åˆ¤æ–­æ˜¯å¦åŒå·ï¼ŒåŒå·ç»“æœä¸ºæ­£æ•°
        $flag = false;
        if (($a < 0 && $b < 0) || ($a > 0 && $b > 0)) {
            $flag = true;
        }

        $dividend = $a > 0 ? -$a : $a; //è¢«é™¤æ•°
        $divisor  = $b > 0 ? -$b : $b; //é™¤æ•°
        if ($dividend > $divisor) {
            return 0;
        }
        //è®¡ç®—ç»“æœçš„ç»å¯¹å€¼
        $res   = 0;
        $shift = 31;
        while ($dividend <= $divisor) {
            while ($dividend > $divisor << $shift) { //å°† $divisor ä¸­çš„ä½å‘å·¦ç§»åŠ¨ $shift æ¬¡ï¼ˆæ¯ä¸€æ¬¡ç§»åŠ¨éƒ½è¡¨ç¤ºâ€œä¹˜ä»¥ 2â€ï¼Œå³â€œä¹˜ä»¥ 2$b â€ï¼‰
                $shift--;
            }
            $dividend -= $divisor << $shift;
            $res      += 1 << $shift;
        }

        return $flag ? $res : -$res;
    }
}
//leetcode submit region end(Prohibit modification and deletion)
