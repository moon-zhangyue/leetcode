<?php
//ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œè¯·ä½ æ‰¾å‡ºå…¶ä¸­ä¸å«æœ‰é‡å¤å­—ç¬¦çš„ æœ€é•¿å­ä¸² çš„é•¿åº¦ã€‚ 
//
// 
//
// ç¤ºä¾‹ 1: 
//
// 
//è¾“å…¥: s = "abcabcbb"
//è¾“å‡º: 3 
//è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ "abc"ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚
// 
//
// ç¤ºä¾‹ 2: 
//
// 
//è¾“å…¥: s = "bbbbb"
//è¾“å‡º: 1
//è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ "b"ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚
// 
//
// ç¤ºä¾‹ 3: 
//
// 
//è¾“å…¥: s = "pwwkew"
//è¾“å‡º: 3
//è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ "wke"ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚
//     è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ"pwke" æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚
// 
//
// ç¤ºä¾‹ 4: 
//
// 
//è¾“å…¥: s = ""
//è¾“å‡º: 0
// 
//
// 
//
// æç¤ºï¼š 
//
// 
// 0 <= s.length <= 5 * 10â´ 
// s ç”±è‹±æ–‡å­—æ¯ã€æ•°å­—ã€ç¬¦å·å’Œç©ºæ ¼ç»„æˆ 
// 
// Related Topics å“ˆå¸Œè¡¨ å­—ç¬¦ä¸² æ»‘åŠ¨çª—å£ ğŸ‘ 6264 ğŸ‘ 0

/*
 * ä¸€æ—¦å‡ºç°æ¶‰åŠæ¬¡æ•°,éœ€è¦ç”¨åˆ°æ•£åˆ—è¡¨
 * æ„é€ å­ä¸²,æ•£åˆ—è¡¨å­˜ä¸‹æ ‡
 * æ¶‰åŠå­ä¸²,è€ƒè™‘æ»‘åŠ¨çª—å£
 * */

//leetcode submit region begin(Prohibit modification and deletion)
class Solution
{
    /**
     * @param String $s
     *
     * @return Integer
     */
    function lengthOfLongestSubstring($s)
    {
        //â‘ 
        $lens = strlen($s);//æ€»çš„å­—ç¬¦ä¸²æœ‰å¤šé•¿
        $tmp  = '';       //ç”¨äºå­˜å‚¨å­ä¸²  å½“å‰é‡Œé¢ä¸ä¼šæœ‰é‡å¤çš„å­—ç¬¦
        $len  = 0;        //æœ€é•¿å­ä¸²çš„é•¿åº¦
        for ($i = 0; $i < $lens; $i++) {
            $re = strpos($tmp, $s[$i]);//åˆ¤æ–­ æ˜¯å¦æœ‰é‡å¤çš„
            if (false !== $re) {//æœ‰é‡å¤
                $tmp .= $s[$i];//å…ˆè¿½åŠ ä¸Šå» ä¾‹å¦‚pww
                $tmp = substr($tmp, $re + 1);//ä»é‡å¤ä½ç½®å¼€å§‹ æˆªå–å pww=>w
            } else {//æ— é‡å¤å­—ç¬¦
                $tmp .= $s[$i];//è¿½åŠ åˆ°åé¢
            }
            //æ¯ä¸€æ¬¡è¿‡å»åï¼Œæ¯”è¾ƒå½“å‰çš„tmp ä¸ä¸Šä¸€æ¬¡çš„ len è°æ›´å¤§
            $len = strlen($tmp) > $len ? strlen($tmp) : $len;
        }
        return $len;//æœ€åè¿”å›çš„é•¿åº¦ ä¸ä¸€å®šæ˜¯$tmp

        //â‘¡
        $n = strlen($s);
        if ($n <= 1) return $n;
        // ç»´æŠ¤ä¸€ä¸ªæ»‘åŠ¨çª—å£ï¼Œçª—å£å†…ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²
        // ä»¥ pwwkew ä¸ºä¾‹ï¼Œéå†æ•´ä¸ªå­—ç¬¦ä¸²
        // left ä¸ºæ»‘åŠ¨çª—å£èµ·ç‚¹ç´¢å¼•ï¼Œ i ä¸ºæ»‘åŠ¨çª—å£ç»ˆç‚¹ç´¢å¼•
        // hash è®°å½•å½“å‰æ»‘åŠ¨çª—å£å†…çš„å­—æ¯ï¼Œé”®ä¸º å­—æ¯ï¼Œå€¼ä¸º ç´¢å¼•
        // å…¨å±€ max è®°å½•çª—å£æœ€å¤§é•¿åº¦
        // left=i=0, çª—å£å†…åªæœ‰ä¸€ä¸ªå­—æ¯ p, length=1, hash=['p' => 0]
        // left=0, i=1, ç´¢å¼• 1 å¯¹åº”çš„å­—æ¯ w ä¸åœ¨ hash å†…ï¼Œçª—å£å‘å³æ»‘åŠ¨, length=2, hash=['p' => 0, 'w' => 1]
        // left=0, right=2, ç´¢å¼• 2 å¯¹åº”çš„å­—æ¯ w åœ¨ hash å†…,çª—å£èµ·ç‚¹è¦æ›´æ–°ä¸ºä¸Šä¸€ä¸ª w çš„ç´¢å¼•çš„ä¸‹ä¸€ä¸ªä½ç½®,left=hash['w'] + 1.
        // åŒæ—¶ï¼Œ hash['w'] æ›´æ–°ä¸ºæ–°çš„ç´¢å¼• ï¼ŒæŒ‡å‘æœ€åä¸€ä¸ª w, hash=['p' => 0, 'w' => 2]
        $left = 0;
        $hash = [];
        $max  = 0;
        for ($i = 0; $i < $n; ++$i) {
            $char = $s[$i];
            if (isset($hash[$char])) {
                $left = max($left, $hash[$char] + 1);
            }

            // æå‰ç»“æŸéå†
            if ($left + $max >= $n) break;

            $hash[$char] = $i;
            $max         = max($max, $i - $left + 1);
        }

        return $max;

        //â‘¢
        //å¯ä»¥è€ƒè™‘ä»ä¸€ä¸ªç©ºå­—ç¬¦ä¸²æ¯æ¬¡å¢åŠ ä¸€ä¸ªå­—ç¬¦ç›´åˆ°sç»“æŸ,
        //å½“å‰å­—ç¬¦ä¸ºs[i],
        //left = max(left, last[s[i]]);è·å¾—çš„åŒºé—´(left, i]æ˜¯ä»¥s[i]ç»“å°¾æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­—ä¸²,
        //å› ä¸ºs[left]ä¸s[i]æ˜¯åŒä¸€ä¸ªå­—ç¬¦,
        //å‡å°leftä¼šæœ‰é‡å¤å­—ç¬¦,
        //ä»0éå†åˆ°s.size()å°±å–åˆ°äº†æ¯ä¸ªå­—ç¬¦ç»“å°¾çš„æœ€é•¿æ— é‡å¤å­—ç¬¦å­—ä¸²,
        //ansè®°å½•å…¶ä¸­çš„æœ€å¤§å€¼,
        $last = array();
        $left = -1;
        $ans  = 0;
//        for ($i = 0; $i < 128; $i++) {
//            $last[$i] = -1;
//        }
        $len = strlen($s);
        for ($i = 0; $i < $len; $i++) {
            $left         = max($left, $last[$s[$i]]);
            $last[$s[$i]] = $i;
            $ans          = max($ans, $i - $left);
        }
        return $ans;
    }
}
//leetcode submit region end(Prohibit modification and deletion)
